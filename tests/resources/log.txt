[2024-07-22 08:46:23][INFO] - This log is also available at '/home/filippo/code/metatrain/tests/resources/outputs/2024-07-22/08-46-23/train.log'.
[2024-07-22 08:46:23][INFO] - Package directory: /home/filippo/code/virtualenvs/base/lib/python3.12/site-packages/metatrain
[2024-07-22 08:46:23][INFO] - Working directory: /home/filippo/code/metatrain/tests/resources
[2024-07-22 08:46:23][INFO] - Metatrain version: 2023.11.29
[2024-07-22 08:46:23][INFO] - Executed command: mtt train options.yaml
[2024-07-22 08:46:23][INFO] - Running training for 'experimental.phace' architecture
[2024-07-22 08:46:24][INFO] - Random seed of this run is 2
[2024-07-22 08:46:24][INFO] - Setting up training set
[2024-07-22 08:46:25][INFO] - Forces found in section 'energy'. Forces are taken for training!
[2024-07-22 08:46:25][WARNING] - No Stress found in section 'energy'. Continue without stress!
[2024-07-22 08:46:25][INFO] - Setting up validation set
[2024-07-22 08:46:25][INFO] - Setting up test set
[2024-07-22 08:46:25][WARNING] - /home/filippo/code/virtualenvs/base/lib/python3.12/site-packages/metatrain/cli/train.py:244: UserWarning: Requested dataset of zero length. This dataset will be empty.
  train_dataset_new, test_dataset = _train_test_random_split(

[2024-07-22 08:46:25][INFO] - Training dataset:
    Dataset of size 50
    Mean and standard deviation of targets:
    - energy: 
      - mean -9.708e+04 kcal/mol
      - std  3.417 kcal/mol
    - forces: 
      - mean -2.635e-09 kcal/mol/Å
      - std  26.54 kcal/mol/Å
[2024-07-22 08:46:25][INFO] - Validation dataset:
    Dataset of size 50
    Mean and standard deviation of targets:
    - energy: 
      - mean -9.708e+04 kcal/mol
      - std  4.298 kcal/mol
    - forces: 
      - mean 8.784e-09 kcal/mol/Å
      - std  29.06 kcal/mol/Å
[2024-07-22 08:46:25][INFO] - Test dataset:
    Dataset of size 0
[2024-07-22 08:46:25][INFO] - Setting up model
species_to_species_index tensor([0, 0, 0, 0, 0, 0, 1, 0, 2], dtype=torch.int32)

BASELINE

l_max 2
n_max_l [2, 2, 1]
n_element_channels 8
k_max_l [16, 16, 8]

[2024-07-22 08:46:25][INFO] - Calling trainer
[2024-07-22 08:46:25][INFO] - training on device cuda with dtype torch.float64
[2024-07-22 08:46:25][INFO] - Calculating composition weights
[2024-07-22 08:46:25][INFO] - Calculating neighbors lists for the datasets
[2024-07-22 08:46:25][INFO] - Setting up data loaders
[2024-07-22 08:46:25][INFO] - Setting up data loaders
[2024-07-22 08:46:28][INFO] - Training with loss weights: {'energy': 1.0, 'forces': 1.0}
[2024-07-22 08:46:28][INFO] - Starting training
[2024-07-22 08:46:29][INFO] - Epoch    0, training loss: 9.523e+05, training energy RMSE (per atom): 0.47147 kcal/mol, training forces RMSE: 26.560 kcal/mol/Å, training energy MAE: 0.37036 kcal/mol, training forces MAE: 19.532 kcal/mol/Å, validation loss: 1.133e+06, validation energy RMSE (per atom): 0.55846 kcal/mol, validation forces RMSE: 28.972 kcal/mol/Å, validation energy MAE: 0.42337 kcal/mol, validation forces MAE: 21.183 kcal/mol/Å
[2024-07-22 08:46:31][INFO] - Epoch    1, training loss: 9.473e+05, training energy RMSE (per atom): 0.43537 kcal/mol, training forces RMSE: 26.490 kcal/mol/Å, training energy MAE: 0.34839 kcal/mol, training forces MAE: 19.457 kcal/mol/Å, validation loss: 1.122e+06, validation energy RMSE (per atom): 0.52239 kcal/mol, validation forces RMSE: 28.830 kcal/mol/Å, validation energy MAE: 0.43377 kcal/mol, validation forces MAE: 21.091 kcal/mol/Å
[2024-07-22 08:46:32][INFO] - Epoch    2, training loss: 9.432e+05, training energy RMSE (per atom): 0.54147 kcal/mol, training forces RMSE: 26.432 kcal/mol/Å, training energy MAE: 0.43568 kcal/mol, training forces MAE: 19.417 kcal/mol/Å, validation loss: 1.121e+06, validation energy RMSE (per atom): 0.86692 kcal/mol, validation forces RMSE: 28.821 kcal/mol/Å, validation energy MAE: 0.74514 kcal/mol, validation forces MAE: 21.037 kcal/mol/Å
[2024-07-22 08:46:34][INFO] - Epoch    3, training loss: 9.380e+05, training energy RMSE (per atom): 0.89996 kcal/mol, training forces RMSE: 26.358 kcal/mol/Å, training energy MAE: 0.80620 kcal/mol, training forces MAE: 19.347 kcal/mol/Å, validation loss: 1.106e+06, validation energy RMSE (per atom): 1.20990 kcal/mol, validation forces RMSE: 28.619 kcal/mol/Å, validation energy MAE: 1.11225 kcal/mol, validation forces MAE: 20.854 kcal/mol/Å
[2024-07-22 08:46:35][INFO] - Epoch    4, training loss: 9.296e+05, training energy RMSE (per atom): 1.83617 kcal/mol, training forces RMSE: 26.239 kcal/mol/Å, training energy MAE: 1.74453 kcal/mol, training forces MAE: 19.242 kcal/mol/Å, validation loss: 1.084e+06, validation energy RMSE (per atom): 2.16407 kcal/mol, validation forces RMSE: 28.338 kcal/mol/Å, validation energy MAE: 2.10411 kcal/mol, validation forces MAE: 20.595 kcal/mol/Å
[2024-07-22 08:46:37][INFO] - Epoch    5, training loss: 9.144e+05, training energy RMSE (per atom): 2.98055 kcal/mol, training forces RMSE: 26.019 kcal/mol/Å, training energy MAE: 2.85842 kcal/mol, training forces MAE: 19.062 kcal/mol/Å, validation loss: 1.073e+06, validation energy RMSE (per atom): 3.58572 kcal/mol, validation forces RMSE: 28.183 kcal/mol/Å, validation energy MAE: 3.54509 kcal/mol, validation forces MAE: 20.439 kcal/mol/Å
[2024-07-22 08:46:38][INFO] - Epoch    6, training loss: 8.869e+05, training energy RMSE (per atom): 3.45939 kcal/mol, training forces RMSE: 25.622 kcal/mol/Å, training energy MAE: 3.42289 kcal/mol, training forces MAE: 18.741 kcal/mol/Å, validation loss: 1.049e+06, validation energy RMSE (per atom): 4.74858 kcal/mol, validation forces RMSE: 27.865 kcal/mol/Å, validation energy MAE: 4.71769 kcal/mol, validation forces MAE: 20.123 kcal/mol/Å
[2024-07-22 08:46:40][INFO] - Epoch    7, training loss: 8.609e+05, training energy RMSE (per atom): 5.22532 kcal/mol, training forces RMSE: 25.233 kcal/mol/Å, training energy MAE: 5.16485 kcal/mol, training forces MAE: 18.303 kcal/mol/Å, validation loss: 1.003e+06, validation energy RMSE (per atom): 6.74673 kcal/mol, validation forces RMSE: 27.233 kcal/mol/Å, validation energy MAE: 6.72015 kcal/mol, validation forces MAE: 19.559 kcal/mol/Å
[2024-07-22 08:46:41][INFO] - Epoch    8, training loss: 8.262e+05, training energy RMSE (per atom): 8.14084 kcal/mol, training forces RMSE: 24.689 kcal/mol/Å, training energy MAE: 8.07623 kcal/mol, training forces MAE: 17.769 kcal/mol/Å, validation loss: 9.559e+05, validation energy RMSE (per atom): 9.04551 kcal/mol, validation forces RMSE: 26.553 kcal/mol/Å, validation energy MAE: 9.02313 kcal/mol, validation forces MAE: 18.930 kcal/mol/Å
[2024-07-22 08:46:43][INFO] - Epoch    9, training loss: 8.218e+05, training energy RMSE (per atom): 8.59645 kcal/mol, training forces RMSE: 24.617 kcal/mol/Å, training energy MAE: 8.48394 kcal/mol, training forces MAE: 17.735 kcal/mol/Å, validation loss: 9.472e+05, validation energy RMSE (per atom): 6.60941 kcal/mol, validation forces RMSE: 26.457 kcal/mol/Å, validation energy MAE: 6.58497 kcal/mol, validation forces MAE: 18.950 kcal/mol/Å
[2024-07-22 08:46:44][INFO] - Epoch   10, training loss: 7.899e+05, training energy RMSE (per atom): 8.95048 kcal/mol, training forces RMSE: 24.127 kcal/mol/Å, training energy MAE: 8.77137 kcal/mol, training forces MAE: 17.415 kcal/mol/Å, validation loss: 9.176e+05, validation energy RMSE (per atom): 6.88521 kcal/mol, validation forces RMSE: 26.037 kcal/mol/Å, validation energy MAE: 6.86308 kcal/mol, validation forces MAE: 18.668 kcal/mol/Å
[2024-07-22 08:46:46][INFO] - Epoch   11, training loss: 7.811e+05, training energy RMSE (per atom): 8.54719 kcal/mol, training forces RMSE: 23.998 kcal/mol/Å, training energy MAE: 8.41600 kcal/mol, training forces MAE: 17.153 kcal/mol/Å, validation loss: 8.994e+05, validation energy RMSE (per atom): 6.31298 kcal/mol, validation forces RMSE: 25.783 kcal/mol/Å, validation energy MAE: 6.29326 kcal/mol, validation forces MAE: 18.516 kcal/mol/Å
[2024-07-22 08:46:47][INFO] - Epoch   12, training loss: 7.615e+05, training energy RMSE (per atom): 7.94849 kcal/mol, training forces RMSE: 23.701 kcal/mol/Å, training energy MAE: 7.77452 kcal/mol, training forces MAE: 17.085 kcal/mol/Å, validation loss: 8.847e+05, validation energy RMSE (per atom): 7.46439 kcal/mol, validation forces RMSE: 25.559 kcal/mol/Å, validation energy MAE: 7.44802 kcal/mol, validation forces MAE: 18.109 kcal/mol/Å
[2024-07-22 08:46:49][INFO] - Epoch   13, training loss: 7.323e+05, training energy RMSE (per atom): 6.89369 kcal/mol, training forces RMSE: 23.252 kcal/mol/Å, training energy MAE: 6.79564 kcal/mol, training forces MAE: 16.654 kcal/mol/Å, validation loss: 8.793e+05, validation energy RMSE (per atom): 8.53653 kcal/mol, validation forces RMSE: 25.468 kcal/mol/Å, validation energy MAE: 8.52034 kcal/mol, validation forces MAE: 18.071 kcal/mol/Å
[2024-07-22 08:46:50][INFO] - Epoch   14, training loss: 7.097e+05, training energy RMSE (per atom): 7.34824 kcal/mol, training forces RMSE: 22.885 kcal/mol/Å, training energy MAE: 7.25048 kcal/mol, training forces MAE: 16.387 kcal/mol/Å, validation loss: 8.718e+05, validation energy RMSE (per atom): 9.42354 kcal/mol, validation forces RMSE: 25.348 kcal/mol/Å, validation energy MAE: 9.40672 kcal/mol, validation forces MAE: 18.081 kcal/mol/Å
[2024-07-22 08:46:52][INFO] - Epoch   15, training loss: 6.822e+05, training energy RMSE (per atom): 8.39506 kcal/mol, training forces RMSE: 22.422 kcal/mol/Å, training energy MAE: 8.34340 kcal/mol, training forces MAE: 16.117 kcal/mol/Å, validation loss: 8.269e+05, validation energy RMSE (per atom): 10.58315 kcal/mol, validation forces RMSE: 24.665 kcal/mol/Å, validation energy MAE: 10.56787 kcal/mol, validation forces MAE: 17.573 kcal/mol/Å
[2024-07-22 08:46:53][INFO] - Epoch   16, training loss: 6.600e+05, training energy RMSE (per atom): 9.33087 kcal/mol, training forces RMSE: 22.038 kcal/mol/Å, training energy MAE: 9.21882 kcal/mol, training forces MAE: 15.800 kcal/mol/Å, validation loss: 7.780e+05, validation energy RMSE (per atom): 10.05546 kcal/mol, validation forces RMSE: 23.928 kcal/mol/Å, validation energy MAE: 10.04115 kcal/mol, validation forces MAE: 16.880 kcal/mol/Å
[2024-07-22 08:46:55][INFO] - Epoch   17, training loss: 6.217e+05, training energy RMSE (per atom): 9.04121 kcal/mol, training forces RMSE: 21.389 kcal/mol/Å, training energy MAE: 8.95479 kcal/mol, training forces MAE: 15.365 kcal/mol/Å, validation loss: 7.304e+05, validation energy RMSE (per atom): 7.84623 kcal/mol, validation forces RMSE: 23.211 kcal/mol/Å, validation energy MAE: 7.82836 kcal/mol, validation forces MAE: 16.480 kcal/mol/Å
[2024-07-22 08:46:56][INFO] - Epoch   18, training loss: 5.963e+05, training energy RMSE (per atom): 9.40922 kcal/mol, training forces RMSE: 20.938 kcal/mol/Å, training energy MAE: 9.21096 kcal/mol, training forces MAE: 15.023 kcal/mol/Å, validation loss: 7.010e+05, validation energy RMSE (per atom): 10.49091 kcal/mol, validation forces RMSE: 22.698 kcal/mol/Å, validation energy MAE: 10.47817 kcal/mol, validation forces MAE: 15.944 kcal/mol/Å
[2024-07-22 08:46:58][INFO] - Epoch   19, training loss: 5.918e+05, training energy RMSE (per atom): 9.74413 kcal/mol, training forces RMSE: 20.853 kcal/mol/Å, training energy MAE: 9.40971 kcal/mol, training forces MAE: 14.974 kcal/mol/Å, validation loss: 6.706e+05, validation energy RMSE (per atom): 8.19313 kcal/mol, validation forces RMSE: 22.232 kcal/mol/Å, validation energy MAE: 8.18030 kcal/mol, validation forces MAE: 15.589 kcal/mol/Å
